# نظام إدارة المحتوى (CMS) - موقع محمد الصافي

## نظرة عامة

تم إضافة نظام إدارة محتوى شامل (CMS) إلى موقع محمد الصافي يتيح للمسؤولين إدارة جميع محتويات الموقع من خلال لوحة تحكم سهلة الاستخدام.

## الميزات الرئيسية

### 1. إدارة الخدمات (Services Management)
- إضافة وتعديل وحذف الخدمات
- تحديد نوع الجلسة (فردية أو للأزواج)
- إدارة الأسعار والمدة والوصف
- إضافة قائمة بالمميزات لكل خدمة
- تفعيل/إلغاء تفعيل الخدمات

### 2. إدارة آراء العملاء (Testimonials Management)
- إضافة وتعديل وحذف آراء العملاء
- تحديد اسم العميل ودوره
- إضافة محتوى الرأي والتقييم (1-5 نجوم)
- تفعيل/إلغاء تفعيل الآراء

### 3. إدارة المقالات (Articles Management)
- إنشاء وتعديل وحذف المقالات
- إضافة عنوان وملخص ومحتوى كامل
- رفع صور الغلاف
- نشر المقالات أو حفظها كمسودات
- إدارة روابط المقالات (slugs)

### 4. إدارة محتوى الصفحات (Page Content Editor)
- تعديل محتوى الصفحات الرئيسية
- تحديث النصوص في الصفحة الرئيسية
- تعديل صفحة "من أنا"
- تحديث محتوى صفحات الخدمات وآراء العملاء

## كيفية الوصول إلى لوحة التحكم

### الخطوة 1: تسجيل الدخول
1. انتقل إلى الصفحة الرئيسية للموقع
2. انقر على زر "تسجيل الدخول" في الزاوية العلوية
3. سجل الدخول باستخدام حساب Google المصرح به

### الخطوة 2: الوصول إلى لوحة التحكم
- بعد تسجيل الدخول، سيظهر زر "لوحة التحكم" في القائمة العلوية
- انقر على الزر للوصول إلى لوحة التحكم الإدارية

## المستخدمون المصرح لهم

المستخدمون التاليون لديهم صلاحيات الوصول الكاملة إلى لوحة التحكم:
- shahadalfahad70@gmail.com
- moalsafiy@gmail.com

## استخدام لوحة التحكم

### إدارة الخدمات

#### إضافة خدمة جديدة:
1. انتقل إلى تبويب "إدارة الخدمات"
2. انقر على زر "+ إضافة خدمة جديدة"
3. املأ النموذج:
   - **عنوان الخدمة**: مثل "جلسات فردية"
   - **نوع الجلسة**: اختر بين فردية أو للأزواج
   - **المدة**: بالدقائق (مثل 60)
   - **السعر**: بالدينار العراقي (مثل 80000)
   - **الوصف**: وصف مختصر للخدمة
   - **المميزات**: كل ميزة في سطر منفصل
   - **الحالة**: نشط أو غير نشط
4. انقر على "إضافة"

#### تعديل خدمة:
1. ابحث عن الخدمة في القائمة
2. انقر على زر "تعديل"
3. عدّل المعلومات المطلوبة
4. انقر على "تحديث"

#### حذف خدمة:
1. ابحث عن الخدمة في القائمة
2. انقر على زر "حذف"
3. أكد عملية الحذف

### إدارة آراء العملاء

#### إضافة رأي جديد:
1. انتقل إلى تبويب "آراء العملاء"
2. انقر على "+ إضافة رأي جديد"
3. املأ النموذج:
   - **اسم العميل**: الاسم الذي سيظهر
   - **الدور/الوصف**: مثل "عميل - جلسات فردية" (اختياري)
   - **التقييم**: من 1 إلى 5 نجوم
   - **محتوى الرأي**: النص الكامل للرأي
   - **الحالة**: نشط أو غير نشط
4. انقر على "إضافة"

#### تعديل رأي:
1. ابحث عن الرأي في القائمة
2. انقر على "تعديل"
3. عدّل المعلومات
4. انقر على "تحديث"

### إدارة المقالات

#### إنشاء مقال جديد:
1. انتقل إلى تبويب "المقالات"
2. انقر على "+ إضافة مقال جديد"
3. املأ النموذج:
   - **عنوان المقال**: العنوان الرئيسي
   - **الرابط (Slug)**: رابط المقال (مثل: my-article)
   - **رابط الصورة**: رابط صورة الغلاف (اختياري)
   - **ملخص المقال**: ملخص قصير (اختياري)
   - **محتوى المقال**: النص الكامل
   - **حالة النشر**: منشور أو مسودة
4. انقر على "إضافة"

### إدارة محتوى الصفحات

#### تعديل محتوى صفحة:
1. انتقل إلى تبويب "محتوى الصفحات"
2. اختر الصفحة المراد تعديلها من القائمة المنسدلة
3. ستظهر جميع الأقسام القابلة للتعديل في هذه الصفحة
4. انقر على "تعديل" بجانب القسم المراد تحديثه
5. عدّل النص في مربع التحرير
6. انقر على "حفظ"

## البنية التقنية

### قاعدة البيانات
- **النظام**: MySQL
- **الجداول الرئيسية**:
  - `services`: الخدمات
  - `testimonials`: آراء العملاء
  - `articles`: المقالات
  - `pageContent`: محتوى الصفحات
  - `bookings`: الحجوزات
  - `analytics`: إحصائيات الزوار
  - `users`: المستخدمين

### API Endpoints
جميع العمليات تتم عبر tRPC API:
- `services.getAll`: جلب جميع الخدمات (للمسؤولين)
- `services.getActive`: جلب الخدمات النشطة (عام)
- `services.create`: إنشاء خدمة جديدة
- `services.update`: تحديث خدمة
- `services.delete`: حذف خدمة
- `testimonials.*`: نفس العمليات للآراء
- `articles.*`: نفس العمليات للمقالات
- `pageContent.*`: عمليات محتوى الصفحات

### الأمان
- جميع عمليات الإدارة محمية بنظام المصادقة
- فقط المستخدمون بدور "admin" يمكنهم الوصول
- التحقق من الصلاحيات على مستوى API

## التشغيل المحلي

### المتطلبات
```bash
# تثبيت MySQL
sudo apt-get install mysql-server

# إنشاء قاعدة البيانات
sudo mysql -e "CREATE DATABASE mohammed_alsafi;"
sudo mysql -e "CREATE USER 'alsafi_user'@'localhost' IDENTIFIED BY 'alsafi_password';"
sudo mysql -e "GRANT ALL PRIVILEGES ON mohammed_alsafi.* TO 'alsafi_user'@'localhost';"
```

### تشغيل المشروع
```bash
# تعيين متغير البيئة
export DATABASE_URL="mysql://alsafi_user:alsafi_password@localhost:3306/mohammed_alsafi"

# تشغيل الترحيلات (Migrations)
pnpm drizzle-kit push

# إضافة البيانات الأولية (اختياري)
pnpm tsx scripts/seed-data.ts

# تشغيل الخادم
pnpm dev
```

## النشر على الإنتاج

### الخيار 1: Vercel (موصى به)

#### 1. إعداد قاعدة البيانات
استخدم أحد الخيارات التالية:
- **PlanetScale**: قاعدة بيانات MySQL مجانية
- **Railway**: قاعدة بيانات MySQL
- **Vercel Postgres**: بديل PostgreSQL

#### 2. تحويل المشروع إلى PostgreSQL (إذا استخدمت Vercel Postgres)
```bash
# تحديث drizzle.config.ts
# تغيير من mysql إلى postgres

# تحديث schema.ts
# استخدام postgres بدلاً من mysql
```

#### 3. النشر على Vercel
```bash
# تثبيت Vercel CLI
npm i -g vercel

# تسجيل الدخول
vercel login

# النشر
vercel

# إضافة متغيرات البيئة في لوحة تحكم Vercel:
# DATABASE_URL=your_database_url
```

### الخيار 2: VPS (مثل DigitalOcean)

```bash
# على الخادم
git clone your-repo
cd mohammed-alsafi-website
pnpm install
pnpm build

# إعداد PM2 لإدارة العملية
pm2 start dist/server/index.js --name "alsafi-website"
pm2 save
pm2 startup
```

## الصيانة والتحديثات

### إضافة مسؤول جديد
عدّل ملف `server/_core/env.ts` وأضف البريد الإلكتروني إلى قائمة المسؤولين.

### النسخ الاحتياطي
```bash
# نسخ احتياطي لقاعدة البيانات
mysqldump -u alsafi_user -p mohammed_alsafi > backup.sql

# استعادة النسخة الاحتياطية
mysql -u alsafi_user -p mohammed_alsafi < backup.sql
```

### تحديث المحتوى
جميع التحديثات تتم من خلال لوحة التحكم - لا حاجة لتعديل الكود.

## الدعم والمساعدة

للحصول على المساعدة أو الإبلاغ عن مشاكل:
1. تحقق من سجلات الخادم (logs)
2. تأكد من اتصال قاعدة البيانات
3. تحقق من صلاحيات المستخدم

## الملاحظات المهمة

- ✅ جميع الصفحات تحمّل المحتوى من قاعدة البيانات
- ✅ نظام المصادقة يعمل بشكل كامل
- ✅ لوحة التحكم محمية ومتاحة للمسؤولين فقط
- ✅ تتبع الزوار والإحصائيات يعمل
- ✅ نظام الحجوزات متكامل مع WhatsApp

## التحسينات المستقبلية المقترحة

1. **Google Analytics**: إضافة تتبع متقدم
2. **رفع الصور**: إضافة نظام رفع الصور مباشرة
3. **محرر نصوص متقدم**: استخدام WYSIWYG editor
4. **إشعارات البريد الإلكتروني**: إرسال إشعارات عند الحجوزات الجديدة
5. **تصدير البيانات**: تصدير الحجوزات والإحصائيات إلى Excel
6. **نظام البحث**: إضافة بحث في المقالات والخدمات
7. **متعدد اللغات**: إضافة دعم للغة الإنجليزية

---

**تم التطوير بواسطة**: Manus AI
**التاريخ**: أكتوبر 2025
**الإصدار**: 2.0

